# Dashboard/Task/Cost ã‚·ã‚¹ãƒ†ãƒ 

ã‚¿ã‚¹ã‚¯ã®çŠ¶æ…‹ç®¡ç†ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºã€ã‚³ã‚¹ãƒˆè¿½è·¡ã‚’å®Ÿç¾ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã®è§£èª¬ã§ã™ã€‚

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Dashboard ã‚·ã‚¹ãƒ†ãƒ æ§‹é€                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  create/update   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Admin  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ Dashboard File  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ (dashboard.md)  â”‚               â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                       â–²                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  read_messages           â”‚                        â”‚
â”‚  â”‚  Admin  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚         â–²                                                       â”‚
â”‚         â”‚ IPC é€šçŸ¥ï¼ˆé€²æ—/å®Œäº†ï¼‰                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                   â”‚
â”‚  â”‚ Worker  â”‚                                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  get_dashboard   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Owner  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ YAML + Markdown â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ (æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿)   â”‚              â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¤‡æ•°ãƒ—ãƒ­ã‚»ã‚¹å¯¾å¿œã®è¨­è¨ˆ

å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ç‹¬ç«‹ã—ãŸ MCP ã‚µãƒ¼ãƒãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã§å‹•ä½œã™ã‚‹ãŸã‚ã€**ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã—ã¾ã›ã‚“**ã€‚

```
Worker ãƒ—ãƒ­ã‚»ã‚¹ â”€â”€ IPC é€šçŸ¥ â”€â”€> Admin ãƒ—ãƒ­ã‚»ã‚¹
                                      â”‚
                                      â”‚ æ›¸ãè¾¼ã¿
                                      â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚    dashboard.md     â”‚
                           â”‚ (å”¯ä¸€ã®çœŸå®Ÿã®æº)     â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–²        â–²        â–²
                            â”‚        â”‚        â”‚
                         èª­ã¿è¾¼ã¿  èª­ã¿è¾¼ã¿  èª­ã¿è¾¼ã¿
                            â”‚        â”‚        â”‚
                      Worker ãƒ—ãƒ­ã‚»ã‚¹  Admin ãƒ—ãƒ­ã‚»ã‚¹  Owner ãƒ—ãƒ­ã‚»ã‚¹
```

**é‡è¦**:
- Worker ã¯ `report_task_progress` / `report_task_completion` ã§ Admin ã¸é€šçŸ¥ã—ã€Dashboard ã‚’ç›´æ¥æ›´æ–°ã—ã¾ã›ã‚“ã€‚
- Dashboard æ›´æ–°ã¯ Admin/Owner å´ã®æ“ä½œï¼ˆä¾‹: `create_task`, `update_task_status`, Admin ã® `read_messages`ï¼‰ã§è¡Œã‚ã‚Œã¾ã™ã€‚
- æ¯å›ãƒ•ã‚¡ã‚¤ãƒ« I/O ã‚’è¡Œã†ãŸã‚ã€å¸¸ã«æœ€æ–°çŠ¶æ…‹ã‚’åæ˜ ã§ãã¾ã™ã€‚

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
{project}/.multi-agent-mcp/{session_id}/
â”œâ”€â”€ dashboard/
â”‚   â””â”€â”€ dashboard.md          # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æœ¬ä½“
â””â”€â”€ tasks/
    â””â”€â”€ {agent_id}.md         # Worker åˆ¥ã‚¿ã‚¹ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«
```

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼

YAML Front Matter + Markdown æœ¬æ–‡ï¼ˆå®Ÿè£…æº–æ‹ ã®ä¾‹ï¼‰:

```markdown
---
workspace_id: abc12345
workspace_path: /path/to/project
updated_at: 2024-01-15T10:20:00
agents:
  - agent_id: worker_xxx
    name: codex1
    role: worker
    status: busy
    current_task_id: task-001
    worktree_path: /path/to/project/.worktrees/feature-task-001
    branch: feature/task-001
    last_activity: 2024-01-15T10:19:00
tasks:
  - id: task-001
    title: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½
    description: JWT èªè¨¼ã®å®Ÿè£…
    status: in_progress
    assigned_agent_id: worker_xxx
    branch: feature/task-001
    worktree_path: /path/to/project/.worktrees/feature-task-001
    progress: 50
    checklist:
      - text: API è¨­è¨ˆ
        completed: true
      - text: å®Ÿè£…
        completed: false
    logs:
      - timestamp: 2024-01-15T10:10:00
        message: ã‚¿ã‚¹ã‚¯é–‹å§‹
    created_at: 2024-01-15T10:05:00
    started_at: 2024-01-15T10:10:00
    completed_at: null
    error_message: null
    metadata: {}
total_agents: 1
active_agents: 1
total_tasks: 1
completed_tasks: 0
failed_tasks: 0
total_worktrees: 1
active_worktrees: 1
cost:
  total_api_calls: 15
  estimated_tokens: 45000
  estimated_cost_usd: 0.45
  actual_cost_usd: 0.12
  total_cost_usd: 0.57
  warning_threshold_usd: 10.0
  calls:
    - ai_cli: claude
      model: claude-3-5-sonnet
      tokens: 3000
      estimated_cost_usd: 0.03
      actual_cost_usd: 0.02
      cost_source: actual
      status_line: null
      timestamp: 2024-01-15T10:10:00
      agent_id: worker_xxx
      task_id: task-001
---

# Multi-Agent Dashboard

**æ›´æ–°æ™‚åˆ»**: 2024-01-15 10:20:00

---

## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹

| ID | åå‰ | å½¹å‰² | çŠ¶æ…‹ | ç¾åœ¨ã®ã‚¿ã‚¹ã‚¯ | worktree |
|:---|:---|:---|:---|:---|:---|
| `worker_xxx` | `codex1` | worker | ğŸ”µ busy | task-001 | `.worktrees/feature-task-001` |

---

## ã‚¿ã‚¹ã‚¯çŠ¶æ…‹

| ID | ã‚¿ã‚¤ãƒˆãƒ« | çŠ¶æ…‹ | æ‹…å½“ | é€²æ— |
|:---|:---|:---|:---|:---|
| `task-001` | ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ | ğŸ”„ in_progress | `codex1` | 50% |

---

## ã‚¿ã‚¹ã‚¯è©³ç´°

### ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½

**é€²æ—**: 50%

**ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**:
- [x] API è¨­è¨ˆ
- [ ] å®Ÿè£…

**æœ€æ–°ãƒ­ã‚°**:
- 10:10 - ã‚¿ã‚¹ã‚¯é–‹å§‹

---

## çµ±è¨ˆ

- **ç·ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ•°**: 1
- **ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: 1
- **ç·ã‚¿ã‚¹ã‚¯æ•°**: 1
- **å®Œäº†ã‚¿ã‚¹ã‚¯**: 0
- **å¤±æ•—ã‚¿ã‚¹ã‚¯**: 0

---

## ã‚³ã‚¹ãƒˆæƒ…å ±

- **ç·APIå‘¼ã³å‡ºã—æ•°**: 15
- **æ¨å®šãƒˆãƒ¼ã‚¯ãƒ³æ•°**: 45,000
- **å®Ÿæ¸¬ã‚³ã‚¹ãƒˆ (Claude)**: $0.1200
- **æ¨å®šã‚³ã‚¹ãƒˆ (å…¨CLI)**: $0.4500
- **åˆç®—ã‚³ã‚¹ãƒˆ**: $0.5700
- **è­¦å‘Šé–¾å€¤**: $10.00
```

## ã‚¿ã‚¹ã‚¯çŠ¶æ…‹é·ç§»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PENDING   â”‚  â† create_task ã§ä½œæˆ
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ assign_task_to_agent
       â”‚ ã¾ãŸã¯ Worker ãŒä½œæ¥­é–‹å§‹
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IN_PROGRESS â”‚  â† started_at ã‚’è¨˜éŒ²
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ report_task_completion
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COMPLETED  â”‚  â† completed_at ã‚’è¨˜éŒ²
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       ã¾ãŸã¯
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FAILED    â”‚  â† completed_at ã‚’è¨˜éŒ²ã€ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’ä¿å­˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### çŠ¶æ…‹ã¨æ—¥æ™‚ã®è¨˜éŒ²

| çŠ¶æ…‹ | è¨˜éŒ²ã•ã‚Œã‚‹æ—¥æ™‚ |
| ---- | -------------- |
| PENDING | `created_at` |
| IN_PROGRESS | `started_at` |
| COMPLETED | `completed_at` |
| FAILED | `completed_at` |

## ã‚³ã‚¹ãƒˆç®¡ç†

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã® API ã‚³ã‚¹ãƒˆã‚’è¿½è·¡ã—ã¾ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ã‚³ã‚¹ãƒˆè¿½è·¡ã®æµã‚Œ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  API å‘¼ã³å‡ºã—    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Worker  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  dashboard.md   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  (cost ã‚»ã‚¯ã‚·ãƒ§ãƒ³)â”‚               â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  get_cost_summary        â”‚                        â”‚
â”‚  â”‚  Admin  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚                        â”‚
â”‚                                       â–¼                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  è­¦å‘Šãƒã‚§ãƒƒã‚¯    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Owner  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ é–¾å€¤è¶…éæ¤œå‡º     â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚³ã‚¹ãƒˆæƒ…å ±ã®æ§‹é€ 

```yaml
cost:
  total_api_calls: 15        # API å‘¼ã³å‡ºã—å›æ•°
  estimated_tokens: 45000    # æ¨å®šãƒˆãƒ¼ã‚¯ãƒ³æ•°
  estimated_cost_usd: 0.45   # æ¨å®šã‚³ã‚¹ãƒˆï¼ˆUSD, å‚è€ƒï¼‰
  actual_cost_usd: 0.12      # å®Ÿæ¸¬ã‚³ã‚¹ãƒˆï¼ˆClaude statusLineï¼‰
  total_cost_usd: 0.57       # åˆç®—ã‚³ã‚¹ãƒˆï¼ˆå®Ÿæ¸¬å„ªå…ˆ + æ¨å®šï¼‰
  warning_threshold_usd: 10.0 # è­¦å‘Šé–¾å€¤ï¼ˆUSDï¼‰
  calls:                     # å‘¼ã³å‡ºã—å±¥æ­´
    - ai_cli: claude
      model: claude-3-5-sonnet
      tokens: 3000
      estimated_cost_usd: 0.03
      actual_cost_usd: 0.02
      cost_source: actual
      status_line: null
      timestamp: 2024-01-15T10:10:00
      agent_id: worker_xxx
      task_id: task-001
```

### ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Šã®è¨ˆç®—

ãƒ¢ãƒ‡ãƒ«ã”ã¨ã® 1K ãƒˆãƒ¼ã‚¯ãƒ³å˜ä¾¡ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã€`MCP_MODEL_COST_TABLE_JSON`ï¼‰:

| ã‚­ãƒ¼ | å˜ä¾¡ (USD / 1K tokens) |
| ---- | ---------------------- |
| `claude:opus` | 0.03 |
| `claude:sonnet` | 0.015 |
| `codex:gpt-5.3-codex` | 0.01 |
| `gemini:gemini-3-pro` | 0.005 |
| `gemini:gemini-3-flash` | 0.0025 |

æœªå®šç¾©ãƒ¢ãƒ‡ãƒ«ã¯ `MCP_MODEL_COST_DEFAULT_PER_1K`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ 0.01ï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

### ã‚³ã‚¹ãƒˆè­¦å‘Š

é–¾å€¤ã‚’è¶…ãˆã‚‹ã¨è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¿”ã•ã‚Œã¾ã™:

```python
# é–¾å€¤ã‚’è¨­å®š
set_cost_warning_threshold(
    threshold_usd=5.0,
    caller_agent_id="owner_xxx"
)

# ã‚³ã‚¹ãƒˆç¢ºèªæ™‚ã«è­¦å‘Šã‚’ãƒã‚§ãƒƒã‚¯
result = get_cost_summary(caller_agent_id="admin_xxx")
summary = result["summary"]
if summary.get("warning_message"):
    print(f"è­¦å‘Š: {summary['warning_message']}")
```

### ã‚³ã‚¹ãƒˆã®é›†è¨ˆæ–¹æ³•

| é›†è¨ˆå˜ä½ | å–å¾—æ–¹æ³• |
| -------- | -------- |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³å…¨ä½“ | `get_cost_summary()` |
| AI CLI åˆ¥ | `get_cost_summary()` ã® `summary.by_cli` |

`by_agent` / `by_task` ã®è©³ç´°å†…è¨³ã¯å†…éƒ¨ãƒ¡ã‚½ãƒƒãƒ‰ `get_cost_detailed_breakdown()` ã®å¯¾è±¡ã§ã€ç¾çŠ¶ MCP ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ã¯å…¬é–‹ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

## ãƒ„ãƒ¼ãƒ«ä¸€è¦§

### ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ„ãƒ¼ãƒ«

| ãƒ„ãƒ¼ãƒ« | èª¬æ˜ | ä½¿ç”¨è€… |
| ------ | ---- | ------ |
| `create_task` | ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ | Owner, Admin |
| `update_task_status` | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–° | Admin |
| `assign_task_to_agent` | Worker ã«å‰²ã‚Šå½“ã¦ | Admin |
| `list_tasks` | ã‚¿ã‚¹ã‚¯ä¸€è¦§å–å¾— | Owner, Admin, Worker |
| `get_task` | ã‚¿ã‚¹ã‚¯è©³ç´°å–å¾— | Owner, Admin, Worker |
| `remove_task` | ã‚¿ã‚¹ã‚¯å‰Šé™¤ | Owner, Admin |
| `report_task_progress` | é€²æ—å ±å‘Šï¼ˆWorkerç”¨ï¼‰ | Worker |
| `report_task_completion` | å®Œäº†å ±å‘Šï¼ˆWorkerç”¨ï¼‰ | Worker |
| `get_dashboard` | ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å…¨ä½“å–å¾— | Owner, Admin, Worker |
| `get_dashboard_summary` | ã‚µãƒãƒªãƒ¼ã®ã¿å–å¾— | Owner, Admin, Worker |

### ã‚³ã‚¹ãƒˆç®¡ç†ãƒ„ãƒ¼ãƒ«

| ãƒ„ãƒ¼ãƒ« | èª¬æ˜ | ä½¿ç”¨è€… |
| ------ | ---- | ------ |
| `get_cost_estimate` | ç¾åœ¨ã®ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Šå–å¾— | Owner, Admin |
| `get_cost_summary` | ã‚³ã‚¹ãƒˆã‚µãƒãƒªãƒ¼å–å¾— | Owner, Admin, Worker |
| `set_cost_warning_threshold` | è­¦å‘Šé–¾å€¤ã‚’è¨­å®š | Owner |
| `reset_cost_counter` | ã‚³ã‚¹ãƒˆã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ | Owner |

## é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

### æ­£ãƒ‡ãƒ¼ã‚¿ã¨äºŒæ¬¡ãƒ‡ãƒ¼ã‚¿

| ç¨®åˆ¥ | ãƒ‡ãƒ¼ã‚¿ | èª¬æ˜ |
| ---- | ------ | ---- |
| **æ­£ãƒ‡ãƒ¼ã‚¿** | `list_tasks()` | ã‚¿ã‚¹ã‚¯ã®çœŸã®çŠ¶æ…‹ |
| **æ­£ãƒ‡ãƒ¼ã‚¿** | `list_agents()` | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®çœŸã®çŠ¶æ…‹ |
| äºŒæ¬¡ãƒ‡ãƒ¼ã‚¿ | `get_dashboard()` | æ•´å½¢ã•ã‚ŒãŸè¦ç´„ï¼ˆå‚è€ƒç”¨ï¼‰ |

**çŸ›ç›¾ãŒã‚ã‚‹å ´åˆã¯æ­£ãƒ‡ãƒ¼ã‚¿ã‚’ä¿¡ç”¨ã—ã¦ãã ã•ã„ã€‚**

### ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã¨é€²æ—ã®é–¢ä¿‚

`report_task_progress` ã« `checklist` ã‚’æ¸¡ã™ã¨ã€Admin ã® `read_messages()` å–ã‚Šè¾¼ã¿æ™‚ã«é€²æ—ãŒè‡ªå‹•è¨ˆç®—ã•ã‚Œã¾ã™:

```python
# Worker ã‹ã‚‰é€²æ— + ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’é€ä¿¡
report_task_progress(
    task_id="task-001",
    message="API è¨­è¨ˆå®Œäº†",
    checklist=[
        {"text": "API è¨­è¨ˆ", "completed": True},
        {"text": "å®Ÿè£…", "completed": False},
        {"text": "ãƒ†ã‚¹ãƒˆ", "completed": False}
    ],
    caller_agent_id="worker_xxx",
)

# Admin ãŒ read_messages() ã‚’å®Ÿè¡Œã™ã‚‹ã¨ Dashboard ã«åæ˜ ã•ã‚Œã‚‹
read_messages(agent_id="admin_xxx", caller_agent_id="admin_xxx")

# 1ã¤å®Œäº† â†’ é€²æ— 33%
# 2ã¤å®Œäº† â†’ é€²æ— 66%
# 3ã¤å®Œäº† â†’ é€²æ— 100%
```

### ãƒ­ã‚°ã®ä¿æŒ

å„ã‚¿ã‚¹ã‚¯ã¯æœ€æ–° 5 ä»¶ã®ãƒ­ã‚°ã‚’ä¿æŒã—ã¾ã™ã€‚  
ãƒ­ã‚°è¿½åŠ ã¯ `report_task_progress` ã® `checklist` çµŒç”±ã§ Admin ãŒå–ã‚Šè¾¼ã‚€éš›ï¼ˆ`read_messages`ï¼‰ã«è¡Œã‚ã‚Œã¾ã™ã€‚

```python
# Worker å´: é€²æ—ã‚’é€ä¿¡
report_task_progress(
    task_id="task-001",
    progress=50,
    message="API å®Ÿè£…å®Œäº†"
)

# Admin å´: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–ã‚Šè¾¼ã¿æ™‚ã«ãƒ­ã‚°ã¸åæ˜ 
read_messages(agent_id="admin_xxx", caller_agent_id="admin_xxx")

# ãƒ­ã‚°æ§‹é€ 
{
    "timestamp": "2024-01-15T10:30:00",
    "message": "API å®Ÿè£…å®Œäº†"
}
```

### Worker ã®å®Œäº†å ±å‘Šãƒ•ãƒ­ãƒ¼

```python
# 1. é€²æ—ã‚’éšæ™‚å ±å‘Šï¼ˆ25% ã”ã¨æ¨å¥¨ï¼‰
report_task_progress(
    task_id="task-001",
    progress=25,
    message="è¨­è¨ˆå®Œäº†",
    caller_agent_id="worker_xxx"
)

# 2. å®Œäº†æ™‚ã« report_task_completion ã‚’å‘¼ã¶
#    ï¼ˆAdmin ã¸ã® IPC è‡ªå‹•é€ä¿¡ã€‚Dashboard æ›´æ–°ã¯ Admin ã® read_messages æ™‚ï¼‰
report_task_completion(
    task_id="task-001",
    status="completed",
    message="ã‚¿ã‚¹ã‚¯å®Œäº†",
    summary="èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã€‚JWT æ–¹å¼ã‚’æ¡ç”¨ã€‚",
    caller_agent_id="worker_xxx"
)
```

## Markdown ç”Ÿæˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã® Markdown å‡ºåŠ›ã«ã¯ä»¥ä¸‹ãŒå«ã¾ã‚Œã¾ã™:

- `# Multi-Agent Dashboard`
- `## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçŠ¶æ…‹`ï¼ˆè¡¨ï¼‰
- `## ã‚¿ã‚¹ã‚¯çŠ¶æ…‹`ï¼ˆè¡¨ï¼‰
- `## ã‚¿ã‚¹ã‚¯è©³ç´°`ï¼ˆé€²è¡Œä¸­ã‚¿ã‚¹ã‚¯ã« checklist/log/error ãŒã‚ã‚‹å ´åˆã®ã¿ï¼‰
- `## çµ±è¨ˆ`ï¼ˆç®‡æ¡æ›¸ãï¼‰
- `## ã‚³ã‚¹ãƒˆæƒ…å ±`ï¼ˆAPI å‘¼ã³å‡ºã—ãŒã‚ã‚‹å ´åˆã®ã¿ã€ç®‡æ¡æ›¸ãï¼‰
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹çµµæ–‡å­—: `â³` pending / `ğŸ”„` in_progress / `âœ…` completed / `âŒ` failed / `ğŸš«` blocked / `ğŸ—‘ï¸` cancelled

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¿ã‚¹ã‚¯ãŒè¡¨ç¤ºã•ã‚Œãªã„

ç¢ºèªäº‹é …:
1. `create_task` ã‚’å‘¼ã‚“ã ã‹
2. æ­£ã—ã„ `session_id` ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹
3. `caller_agent_id` ã‚’æŒ‡å®šã—ãŸã‹

```python
# æ­£ã—ã„å‘¼ã³å‡ºã—ä¾‹
create_task(
    title="ã‚¿ã‚¹ã‚¯å",
    description="èª¬æ˜",
    caller_agent_id="admin_xxx"  # å¿…é ˆ
)
```

### é€²æ—ãŒæ›´æ–°ã•ã‚Œãªã„

ç¢ºèªäº‹é …:
1. `report_task_progress` ã‚’å‘¼ã‚“ã§ã„ã‚‹ã‹
2. Worker ã® `caller_agent_id` ãŒæ­£ã—ã„ã‹

```python
# Worker ã‹ã‚‰ã®é€²æ—å ±å‘Š
report_task_progress(
    task_id="task-001",
    progress=50,
    message="é€²æ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
    caller_agent_id="worker_xxx"  # Worker è‡ªèº«ã® ID
)
```

### Dashboard ã¨ list_tasks ã®çµæœãŒç•°ãªã‚‹

`get_dashboard` ã¯æ•´å½¢ã•ã‚ŒãŸè¡¨ç¤ºç”¨ãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚
**æ­£ç¢ºãªçŠ¶æ…‹ã‚’å–å¾—ã™ã‚‹ã«ã¯ `list_tasks` ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚**

```python
# æ­£ç¢ºãªã‚¿ã‚¹ã‚¯çŠ¶æ…‹
tasks = list_tasks(caller_agent_id="admin_xxx")
for task in tasks:
    print(f"{task['id']}: {task['status']}")
```

### ã‚³ã‚¹ãƒˆãŒè¨˜éŒ²ã•ã‚Œãªã„

ç¢ºèªäº‹é …:

1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã‚‹ã‹
2. `session_id` ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹

```python
# ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åˆæœŸåŒ–ç¢ºèª
dashboard = get_dashboard(caller_agent_id="admin_xxx")
if dashboard.get("error"):
    # init_tmux_workspace ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹
    pass
```

### ã‚³ã‚¹ãƒˆè­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œãªã„

ç¢ºèªäº‹é …:

1. é–¾å€¤ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹
2. ã‚³ã‚¹ãƒˆãŒé–¾å€¤ã‚’è¶…ãˆã¦ã„ã‚‹ã‹

```python
# é–¾å€¤ã®ç¢ºèªã¨è¨­å®š
result = get_cost_summary(caller_agent_id="admin_xxx")
summary = result["summary"]
print(f"ç¾åœ¨ã®ã‚³ã‚¹ãƒˆ: ${summary['estimated_cost_usd']}")
print(f"é–¾å€¤: ${summary['warning_threshold_usd']}")

# é–¾å€¤ã‚’ä¸‹ã’ã¦ãƒ†ã‚¹ãƒˆ
set_cost_warning_threshold(
    threshold_usd=0.10,
    caller_agent_id="owner_xxx"
)
```

### ã‚³ã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆã—ãŸã„

æ–°ã—ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹ã‹ã€`reset_cost_counter` ã‚’ä½¿ç”¨:

```python
# ã‚³ã‚¹ãƒˆã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
result = reset_cost_counter(caller_agent_id="owner_xxx")
print(f"ãƒªã‚»ãƒƒãƒˆã•ã‚ŒãŸå‘¼ã³å‡ºã—æ•°: {result['deleted_count']}")
```
